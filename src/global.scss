/*
 * App Global CSS
 * ----------------------------------------------------------------------------
 * Put style rules here that you want to apply globally. These styles are for
 * the entire app and not just one component. Additionally, this file can be
 * used as an entry point to import other CSS/Sass files to be included in the
 * output CSS.
 * For more information on global stylesheets, visit the documentation:
 * https://ionicframework.com/docs/layout/global-stylesheets
 */

/* Core CSS required for Ionic components to work properly */
@import "@ionic/angular/css/core.css";

/* Basic CSS for apps built with Ionic */
@import "@ionic/angular/css/normalize.css";
@import "@ionic/angular/css/structure.css";
@import "@ionic/angular/css/typography.css";
@import "@ionic/angular/css/display.css";

/* Optional CSS utils that can be commented out */
@import "@ionic/angular/css/padding.css";
@import "@ionic/angular/css/float-elements.css";
@import "@ionic/angular/css/text-alignment.css";
@import "@ionic/angular/css/text-transformation.css";
@import "@ionic/angular/css/flex-utils.css";

:root {
  --ion-color-primary: #175873;
  --ion-color-primary-rgb: 23, 88, 115;
  --ion-color-primary-contrast: #ffffff;
  --ion-color-primary-contrast-rgb: 255, 255, 255;
  --ion-color-primary-shade: #12465c;
  --ion-color-primary-tint: #2c6c8a; // Adjusted tint for better visibility in dark mode if used directly
  
  // Lighter tints for hover/active states if needed
  --ion-color-primary-tint-lighter: rgba(var(--ion-color-primary-rgb), 0.15);
  --ion-color-primary-tint-lightest: rgba(var(--ion-color-primary-rgb), 0.08);

  --ion-color-warning-tint-lightest: rgba(var(--ion-color-warning-rgb), 0.05);


  --primary-gradient: linear-gradient(167deg,rgba(11, 53, 71, 1) 0%, rgba(35, 121, 158, 1) 66%, rgba(16, 66, 87, 1) 100%);

  --ion-text-color: #222428;
  --ion-text-color-rgb: 34, 36, 40;
  --ion-color-step-850: #555555; // Darker grey for better contrast on light bg
  --ion-color-medium-shade: #757575; // General medium shade for less important text/icons

  --ion-background-color: #f4f5f8;
  --ion-background-color-rgb: 244, 245, 248;
  
  --ion-toolbar-background: var(--ion-color-primary); // Default toolbar for light (can be overridden by gradient)
  --ion-toolbar-text-color: var(--ion-color-primary-contrast);

  --legal-buttons: #eeeeee; // Keep for legal page if specific styling is intended
  --ion-tab-bar-background: #ffffff;
  --ion-card-background: #ffffff;
  --ion-item-background: #ffffff;
  --ion-item-background-tint: rgba(0,0,0,0.02); // For subtle background difference like task list container
  --ion-list-header-background: #f0f0f0;
  --ion-list-background: #ffffff;
  --ion-border-color: #e0e0e0; // Default border color

  --mat-autocomplete-background-color: #fdfdfd; // For ng-country-select
  --mat-sys-surface-container: #fdfdfd; // For ng-country-select
}

@media (prefers-color-scheme: dark) {
  body {
    --ion-color-primary: #2c6c8a; // Brighter primary for dark mode
    --ion-color-primary-rgb: 44, 108, 138;
    --ion-color-primary-contrast: #ffffff;
    --ion-color-primary-shade: #255a73;
    --ion-color-primary-tint: #3f89a7;

    --ion-color-primary-tint-lighter: rgba(var(--ion-color-primary-rgb), 0.25); // More visible tint on dark
    --ion-color-primary-tint-lightest: rgba(var(--ion-color-primary-rgb), 0.15);
    
    --ion-color-warning-tint-lightest: rgba(var(--ion-color-warning-rgb), 0.1);


    // Secondary, Tertiary, Status colors are often kept the same or slightly adjusted
    // --ion-color-secondary: #50c8ff; (Example, if defined)

    --ion-color-tertiary: #6a64ff;
    --ion-color-success: #2dd36f;
    --ion-color-warning: #ffc409;
    --ion-color-danger: #eb445a;
    
    --ion-color-dark: #f4f5f8; // Light elements on dark backgrounds
    --ion-color-medium: #989aa2; // Medium elements
    --ion-color-light: #222428; // Dark elements on light areas within dark mode (e.g. selected card)

    --ion-text-color: #e0e0e0; // Main text color, slightly off-white
    --ion-text-color-rgb: 224, 224, 224;
    --ion-color-step-100: #2a2a2a; // Darker UI element backgrounds
    --ion-color-step-150: #363636;
    --ion-color-step-200: #414141;
    --ion-color-step-850: #b0b0b0; // Lighter text for subtitles, placeholder
    --ion-color-medium-shade: #8a8a8a;

    --ion-background-color: #121212;
    --ion-background-color-rgb: 18, 18, 18;

    --ion-item-background: #1e1e1e;
    --ion-item-background-tint: rgba(255,255,255,0.03);
    --ion-toolbar-background: #1f1f1f;
    --ion-toolbar-text-color: var(--ion-text-color); // General toolbar text in dark mode

    --legal-buttons: #333333; // Darker buttons for legal page
    --ion-tab-bar-background: #1f1f1f;
    --ion-card-background: #1e1e1e;
    --ion-list-header-background: #2a2a2a;
    --ion-list-background: #1e1e1e; // Can be same as item background or slightly different
    --ion-border-color: #383838; // Darker border color

    // Material select dark mode (for ng-country-select)
    --mat-autocomplete-background-color: #303030;
    --mat-sys-surface-container: #303030;
  }

  // General dark mode overrides for common elements
  ion-content {
    --background: var(--ion-background-color);
  }

  // Login page specific dark mode
  .login-page-wrapper ion-card {
    background: var(--ion-card-background); // Use card background
  }
  .login-page-wrapper h1,
  .login-page-wrapper h3 {
    color: var(--ion-text-color);
  }
  .login-page-wrapper h1 span::after,
  .login-page-wrapper h3::before {
    background-color: var(--ion-border-color);
  }
  .login-page-wrapper .additional-signin svg {
    fill: var(--ion-color-medium);
    &:hover {
      fill: var(--ion-text-color);
    }
  }

  // Account page specific dark mode
  app-account ion-list-header { // Target component directly
    --background: var(--ion-list-header-background);
    h1 { color: var(--ion-color-step-850); }
  }
  app-account ion-item {
    --background: var(--ion-item-background);
  }
  app-account ion-label, app-account ion-input, app-account ion-toggle {
    color: var(--ion-text-color);
  }
   app-account ion-item-divider {
    --background: var(--ion-background-color);
    --color: var(--ion-color-step-850);
  }


  // Legal popup specific dark mode
  app-legal-popup ion-header ion-toolbar {
    --background: var(--ion-toolbar-background);
    ion-title { color: var(--ion-toolbar-text-color); }
  }
  app-legal-popup ion-content {
    --background: var(--ion-background-color);
    color: var(--ion-text-color);
    h1 { color: var(--ion-text-color); }
  }
   app-legal-popup ion-footer ion-toolbar {
     --background: var(--ion-toolbar-background);
   }
   app-legal-popup .choices ion-button {
     --background: var(--legal-buttons);
     --color: var(--ion-text-color); // Text on buttons
   }


  // Tabs specific dark mode
  ion-tab-bar {
    --background: var(--ion-tab-bar-background);
    border-top: 1px solid var(--ion-border-color); // Add subtle top border
  }
  ion-tab-button {
    --color: var(--ion-color-medium);
    --color-selected: var(--ion-color-primary); // Use dark mode primary
  }

  // Chatbot specific dark mode is handled in its component SCSS

  // Checklist specific dark mode is handled in its component SCSS

  // Quiz specific dark mode is handled in its component SCSS
}

// Global Message Area Styles (Chatbot)
.messages-area {
  padding-bottom: 10px;
}

.message {
  max-width: 75%; // Slightly wider max-width
  word-wrap: break-word;
  white-space: normal;
  width: fit-content;
  position: relative;
  padding: 10px 14px; // Adjust padding
  border-radius: 18px; // Softer radius
  z-index: 2; // Keep for tail
  opacity: 0;
  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
  transform: translateY(10px); // Initial state for animation
  margin-bottom: 10px; // Increased spacing

    h1, h2, h3, h4, h5, h6 {
    margin-top: 0.8em;
    margin-bottom: 0.4em;
    line-height: 1.2;
    font-weight: 600; // Or your theme's heading weight
    color: inherit;   // Inherit color from the .message bubble (user or bot side)
  }
  // You can adjust specific heading sizes if needed
  h1 { font-size: 1.5em; }  // Example
  h2 { font-size: 1.3em; }  // Example
  h3 { font-size: 1.15em; } // Example
  h4 { font-size: 1.05em; }
  h5 { font-size: 1em; }
  h6 { font-size: 0.9em; }

  p { // Paragraphs within the markdown content
    margin-top: 0;
    margin-bottom: 0.6em; // Slightly more space between paragraphs
    line-height: 1.5;
     &:last-child {
      margin-bottom: 0; // No bottom margin for the last paragraph in a message
    }
  }

  ul, ol {
    margin-top: 0.5em;
    margin-bottom: 0.8em; // More space after lists
    padding-left: 25px;   // Standard list indentation
  }

  li {
    margin-bottom: 0.3em;
    line-height: 1.5;
  }

  strong, b {
    font-weight: bold; // Or your theme's bold weight: var(--ion-font-weight-bold);
  }

  em, i {
    font-style: italic;
  }

  code { // Inline code
    font-family: monospace; // Or your preferred monospace font: var(--ion-font-family-monospace);
    background-color: var(--ion-color-step-100, rgba(128, 128, 128, 0.1)); // Use theme steps
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
    color: inherit; // Ensure it uses text color of the bubble
  }

  pre { // Code blocks
    background-color: var(--ion-color-step-100, rgba(128, 128, 128, 0.1));
    padding: 12px;
    border-radius: 6px;
    overflow-x: auto; // Allow horizontal scrolling for long code lines
    margin-top: 0.5em;
    margin-bottom: 0.8em;
    font-size: 0.9em;

    code { // Code inside pre should not have its own background or padding
      background-color: transparent;
      padding: 0;
      border-radius: 0;
      font-size: 1em; // Inherit pre's font size
    }
  }

  hr { // For the "---" lines (horizontal rule)
    border: 0;
    height: 1px;
    background-color: var(--ion-border-color); // Use your app's border color
    margin-top: 1.2em;
    margin-bottom: 1.2em;
  }

  a {
    color: var(--ion-color-primary); // Use your app's primary color for links
    text-decoration: underline;
    &:hover {
      text-decoration: none; // Or a different hover effect
    }
  }

  blockquote {
    margin-left: 0;
    margin-right: 0;
    padding-left: 1em;
    border-left: 4px solid var(--ion-color-medium-tint, #ccc);
    color: var(--ion-color-medium-shade, #555);
    font-style: italic;
    margin-top: 0.5em;
    margin-bottom: 0.8em;
  }

  table {
    border-collapse: collapse;
    width: auto; // Or 100% if you want full-width tables within messages
    margin-top: 0.5em;
    margin-bottom: 0.8em;
    th, td {
      border: 1px solid var(--ion-border-color);
      padding: 6px 10px;
      text-align: left;
    }
    th {
      background-color: var(--ion-color-step-50, #f9f9f9); // Light background for table headers
      font-weight: 600;
    }
  }
}

@media (prefers-color-scheme: dark) {
  .message {
    code { // Inline code in dark mode
      background-color: var(--ion-color-step-200, rgba(255, 255, 255, 0.15));
    }
    pre { // Code blocks in dark mode
      background-color: var(--ion-color-step-200, rgba(255, 255, 255, 0.15));
    }
    blockquote {
      border-left-color: var(--ion-color-medium, #777);
      color: var(--ion-color-step-850, #aaa);
    }
    table {
      th {
        background-color: var(--ion-color-step-150, #333);
      }
    }
  }
}

.message.appear { // Renamed class for clarity
  opacity: 1;
  transform: translateY(0);
}

// Remove shake animation - it's often distracting for chat
// .shake { animation: gelatine 0.5s 1; }
// @keyframes gelatine { ... }

.user-side {
  margin-left: auto;
  margin-right: 10px; // Consistent spacing
  background: var(--ion-color-primary);
  color: var(--ion-color-primary-contrast);
  border-bottom-right-radius: 6px; // Tail effect adjustment
}
.user-side:after {
  content: '';
  bottom: 0px; // Align with bottom
  right: -8px; // Closer to bubble
  position: absolute;
  width: 15px; // Smaller tail
  height: 15px;
  background-color: transparent;
  border-bottom-left-radius: 10px;
  box-shadow: -5px 5px 0px 0px var(--ion-color-primary); // Simpler tail
  z-index: 1;
}

.bot-side {
  margin-right: auto;
  margin-left: 10px;
  background: var(--ion-item-background); // Consistent with item backgrounds
  color: var(--ion-text-color);
  border-bottom-left-radius: 6px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.bot-side:after {
  content: '';
  bottom: 0px;
  left: -8px;
  position: absolute;
  width: 15px;
  height: 15px;
  background-color: transparent;
  border-bottom-right-radius: 10px;
  box-shadow: 5px 5px 0px 0px var(--ion-item-background);
  z-index: 1;
}

@media (prefers-color-scheme: dark) {
  .bot-side {
    background: var(--ion-color-step-150);
    color: var(--ion-text-color);
  }
   .bot-side:after {
     box-shadow: 5px 5px 0px 0px var(--ion-color-step-150);
   }
}


// Global Header Styles
ion-header {
  // Ensure gradient is applied if this is the primary header style
  // Individual pages might override this if they need a solid color.
  // background: var(--primary-gradient); // Default gradient for all headers
  // color: var(--ion-color-primary-contrast);

  // ion-toolbar {
  //   --background: transparent; // Make toolbars transparent to show gradient
  //   color: var(--ion-color-primary-contrast);
  // }
  // ion-title.centered-title, .header-button {
  //   color: var(--ion-color-primary-contrast);
  // }
}
// This ^ was commented out because individual pages (checklist, quiz) set their header gradient.
// Login page uses a different gradient. Dashboard/Chatbot use solid primary. This approach is fine.

.centered-title {
  text-align: center;
  // Removed absolute positioning for more robust centering with flex, handled by Ionic slots
}

.header-button {
  // color is set by toolbar context or can be explicit
}

// Global Content & Button Wrappers
.content-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  padding: 16px; // Add global padding to content wrappers
  box-sizing: border-box;
}

.button-wrapper { // Used in Quiz
  width: 100%; // Takes width from parent (.content-wrapper)
  max-width: 600px; // Consistent max-width
  margin-top: 20px;
  margin-bottom: 20px;
}

.hidden {
  display: none !important;
}

// Alert Controller Button Styling (more globally)
.alert-button-cancel {
  // Standard cancel button styling (often less prominent)
}
.alert-button-confirm {
  // Standard confirm button styling
}
.alert-button-destructive {
  color: var(--ion-color-danger) !important; // Ensure destructive color is applied
}

// Custom Toast Styling (Example)
.custom-toast {
  // --background: var(--ion-color-dark);
  // --color: var(--ion-color-light);
  // font-size: 0.9rem;
}

/* Ionic Dark Mode - System preference */
@import "@ionic/angular/css/palettes/dark.system.css";